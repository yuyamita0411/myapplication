version: '3'
services:
  myapp_nginx:
    build: ./API/environment/local/nginx
    container_name: 'SslMyapp'
    #<Host Port>:<Container Port> 
    ports:
      - '8081:443'
      - '8082:80'
    volumes:
      - ./API/environment/local/ssl:/etc/nginx/ssl
      - ./API/environment/local/nginx:/etc/nginx/conf.d
      - ./API/source:/var/www/html/gware
      - ./API/log:/var/log/nginx
    links:
      - webappservice
    networks:
        myapp_network:
            ipv4_address: 188.39.0.2

  webappservice:
      restart: always
      container_name: webappservice
      build: ./API/environment/local/php
      volumes:
          - ./API/source:/var/www/html/gware
      networks:
          myapp_network:
              ipv4_address: 188.39.0.3

  myapp_mysql:
      restart: always
      container_name: myapp_mysql
      build: ./API/environment/local/mysql
      environment:
          MYSQL_DATABASE: myapp_Database
          MYSQL_ROOT_PASSWORD: myapp_Password
          MYSQL_USER: myapp_User
          MYSQL_PASSWORD: Password
          TZ: Asia/Tokyo
      ports:
          - 3306:3306
      networks:
          myapp_network:
              ipv4_address: 188.39.0.4

  myapp_phpmyadmin:
      restart: always
      image: phpmyadmin/phpmyadmin
      container_name: myapp_phpmyadmin
      environment:
          - PMA_ARBITRARY=1
          - PMA_HOST=myapp_mysql
          - PMA_USER=myapp_User
          - PMA_PASSWORD=Password
      links:
          - myapp_mysql
      ports:
          - 7070:80

      networks:
          myapp_network:
              ipv4_address: 188.39.0.5

networks:
    myapp_network:
        driver: bridge
        ipam:
            driver: default
            config:
                - subnet: 188.39.0.0/24